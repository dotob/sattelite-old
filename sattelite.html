<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>sattelite</title>
</head>

<!-- 
iron router renders templates automatically within the body tag, 
so there's no need to call the takeaways template here.
actually, parts of the takeaway template would be rendered twice if you did.
the outer div wasn't needed anyways...
-->
<body>
{{> loginButtons}}
</body>

<template name="takeaways">
  <div class="row">
    <div class="medium-6 columns">
      <h2>So you want to start a foodrun?</h2>
      <h4 class="subheader">Great! go ahead and choose a takeaway you want to order food with:</h4>
      {{#each takeaways}}
        {{> takeawaysListItem}}
      {{/each}}
    </div>
    <div class="medium-6 columns">
      {{#unless currentUser}}
        <h3>log in to start a food run.</h3>
      {{/unless}}
      {{#if foodruns.count}}
        <h2>But wait... There are allready foodruns!</h2>
        <h4 class="subheader">So spare the hassle and just take part in one. Hmmmm, yum yum!</h4>
        {{#each foodruns}}
          <hr />
          <div class="medium-6 columns">
            <h3>{{takeaway.name}}</h3>
            <p>{{takeaway.description}} <br />
              organized by: {{organizer.username}}</p>
          </div>
          <div class="medium-6 columns">
            <a href="{{pathFor 'foodrun'}}">Show foodrun</a>
          </div>
        {{/each}}
      {{/if}}
    </div>

  </div>
</template>

<template name="takeawaysListItem">
  <hr />
  <div class="row">
    <div class="medium-8 columns">
      <h3>{{name}}</h3>
      <p>{{description}}</p>
    </div>
    <div class="medium-4 columns">
      <a href="{{pathFor 'takeaway'}}">Show takeaway</a>
      {{#if currentUser}}
        <a class="startFoodrun" href="#">Start foodrun</a>
      {{/if}}
    </div>
  </div>
</template>


<template name="takeaway">
  <div class="takeaway">
    {{#with takeaway}}
      <h2>{{name}}</h2> 
      <p>{{description}}</p>
      <p>{{phone}}</p>
    {{/ with}}
  </div>
</template>

<template name="foodrun">
  <div class="foodrun">
    {{#with foodrun}}
      {{#if bespokenDishes}}
        <h2>Those are the dishes allready bespoken:</h2>
        {{#each bespokenDishes}}
          <h3>{{name}}</h3>
          <h4>bespoken by: {{bespokenBy.username}}</h4>
        {{/each}}
      {{/if}}
      <h2>This foodrun goes to: {{takeaway.name}}</h2>
      <p>This is the menu.</p>
      {{#each takeaway.dishes}}
        {{> dishesListItem}}
      {{/each}}
    {{/with}}
  </div>
</template>

<template name="dishesListItem">
  <h3>{{name}}</h3>
  {{#if currentUser}}
    <a class="bespeakDish" href="#">bespeak dish</a>
  {{/if}}
</template>
