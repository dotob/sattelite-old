<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <title>sattelite</title>
</head>

<!-- 
iron router renders templates automatically within the body tag, 
so there's no need to call the takeaways template here.
actually, parts of the takeaway template would be rendered twice if you did.
the outer div wasn't needed anyways...
-->
<body>
{{> loginButtons}}
</body>

<template name="takeaways">
  <div class="takeaways">
    
    {{#unless currentUser}}
      <h2>logged not in.</h2>
    {{/unless}}

    {{#if foodruns.count}}
      <h1>There are allready foodruns to:</h1>
      {{#each foodruns}}
        <h2>{{takeaway.name}}</h2>
        <h3>organizer: {{organizer.username}}</h3>
        <a href="{{pathFor 'foodrun'}}">Show foodrun</a>
      {{/each}}
    {{/if}}
    
    <h1>Choose a takeaway.</h1>
    {{#each takeaways}}
      {{> takeawaysListItem}}
    {{/each}}

  </div>
</template>

<template name="takeawaysListItem">
  <h2>{{name}}</h2>
  <a href="{{pathFor 'takeaway'}}">Show takeaway</a>
  {{#if currentUser}}
    <a class="startFoodrun" href="#">Start foodrun</a>
  {{/if}}
</template>


<template name="takeaway">
  <div class="takeaway">
    {{#with takeaway}}
      <h2>{{name}}</h2> 
      <p>{{description}}</p>
      <p>{{phone}}</p>
    {{/ with}}
  </div>
</template>

<template name="foodrun">
  <div class="foodrun">
    {{#with foodrun}}
      {{#if bespokenDishes}}
        <h2>Those are the dishes allready bespoken:</h2>
        {{#each bespokenDishes}}
          <h3>{{name}}</h3>
        {{/each}}
      {{/if}}
      <h2>This foodrun goes to: {{takeaway.name}}</h2>
      <p>This is the menu.</p>
      {{#each takeaway.dishes}}
        {{> dishesListItem}}
      {{/each}}
    {{/with}}
  </div>
</template>

<template name="dishesListItem">
  <h3>{{name}}</h3>
  {{#if currentUser}}
    <a class="bespeakDish" href="#">bespeak dish</a>
  {{/if}}
</template>
