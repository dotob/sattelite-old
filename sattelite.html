<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/pure-min.css">
  <!--[if lte IE 8]>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.5.0/grids-responsive-min.css">
  <!--<![endif]-->>>>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>sattelite</title>
</head>

<!-- 
iron router renders templates automatically within the body tag, 
so there's no need to call the takeaways template here.
actually, parts of the takeaway template would be rendered twice if you did.
the outer div wasn't needed anyways...
-->
<body>
{{> loginButtons}}
</body>

<template name="takeaways">
  {{#if currentUser}}
    <div class="pure-g">
      {{#if foodruns.count}}
        <div class="l-box pure-u-1 pure-u-md-1-2">
          <h2>Those are the foodruns allready on.</h2>
          <h4>Spare the hassle and just take part in one. Hmmmm, yum yum!</h4>
          {{#each foodruns}}
            <hr />
            <div class="l-box pure-u-1 pure-u-md-1-2">
              <h3>{{takeaway.name}}</h3>
              <p>{{takeaway.description}} <br />
                organized by: {{organizer.username}}</p>
            </div>
            <div class="l-box pure-u-1 pure-u-md-1-2">
              <a href="{{pathFor 'foodrun'}}">Show foodrun</a>
            </div>
          {{/each}}
        </div>
      {{/if}}
      <div class="l-box pure-u-1 pure-u-md-1-2">
        <h2>Do you want to start a foodrun?</h2>
        <h4>Great! go ahead and choose a takeaway you want to order food with:</h4>
        {{#each takeaways}}
          {{> takeawaysListItem}}
        {{/each}}
      </div>
    </div>
  {{else}}
    <div class="pure-g">
      <div class="l-box pure-u-1">
        <h1>This is <b>sattelite</b></h1>
        <h3>Log in to start a food run or to take part in one.</h3>
      </div>
    </div>
  {{/if}}
</template>

<template name="takeawaysListItem">
  <hr />
  <div class="pure-g">
    <div class="l-box pure-u-2-3">
      <h3>{{name}}</h3>
      <p>{{description}}</p>
    </div>
    <div class="l-box pure-u-1-3">
      <a href="{{pathFor 'takeaway'}}">Show takeaway</a>
      {{#if currentUser}}
        <br />
        <a class="startFoodrun" href="#">Start foodrun</a>
      {{/if}}
    </div>
  </div>
</template>


<template name="takeaway">
  <div class="pure-g">
    <div class="l-box pure-u-1">
      {{#with takeaway}}
        <h2>{{name}}</h2> 
        <p>{{description}}</p>
        <p>{{phone}}</p>
      {{/ with}}
      <h3>The menu:</h3>
      {{#each takeaway.dishes}}
        <p>{{name}}</p>
      {{/each}}
    </div>
  </div>
</template>

<template name="foodrun">
  <div class="pure-g">
    {{#with foodrun}}
      <div class="l-box pure-u-1 pure-u-md-1-2">
        <h2>This foodrun goes to: {{takeaway.name}}</h2>
        <p>This is the menu.</p>
        {{#each takeaway.dishes}}
          {{> dishesListItem}}
        {{/each}}
      </div>
      {{#if bespokenDishes}}
        <div class="l-box pure-u-1 pure-u-md-1-2">
          <h2>Those are the dishes allready bespoken.</h2>
          <p>Go ahead. All delicious.</p>
          {{#each bespokenDishes}}
            <hr />
            <h3>{{name}}</h3>
            <h4>bespoken by: {{bespokenBy.username}}</h4>
          {{/each}}
        </div>
      {{/if}}
    {{/with}}
  </div>
</template>

<template name="dishesListItem">
  <hr />
  <h3>{{name}}</h3>
  {{#if currentUser}}
    <a class="bespeakDish" href="#">bespeak dish</a>
  {{/if}}
</template>
